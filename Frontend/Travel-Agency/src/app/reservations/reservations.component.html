<div class="reservations-container">
  <h2>My Reservations</h2>

  <div *ngIf="reservations.length === 0">
    <p>You have no reservations yet.</p>
  </div>

  <div *ngFor="let reservation of reservations" class="trip-card">
    <h3>{{ reservation.tripDTO.title }}</h3>
    
    <p><strong>Location:</strong> {{ reservation.tripDTO.cityName }}</p>
    <p><strong>From:</strong> {{ reservation.tripDTO.startDate | date: 'mediumDate' }}</p>
    <p><strong>To:</strong> {{ reservation.tripDTO.endDate | date: 'mediumDate' }}</p>
    <p><strong>Price per person:</strong> ${{ reservation.tripDTO.price }}</p>
    <p><strong>Number of People:</strong> {{ reservation.numberOfPeople }}</p>
    <p><strong>Total Price:</strong> ${{ reservation.totalPrice }}</p>
    
    <p>
      <strong>Status:</strong>
      <span [ngClass]="{
        'text-success': reservation.status === 'ACTIVE',
        'text-warning': reservation.status === 'PENDING',
        'text-danger': reservation.status === 'CANCELLED'
      }">
        {{ reservation.status }}
      </span>
    </p>

    <p *ngIf="reservation.status === 'CANCELLED' && reservation.cancellationReason">
      <strong>Cancellation Reason:</strong> {{ reservation.cancellationReason }}
    </p>

    <div class="action-buttons mt-3">
      <button
        *ngIf="reservation.status === 'PENDING' || reservation.status === 'ACTIVE'"
        (click)="cancel(reservation.id)"
        class="btn btn-danger me-2"
      >
        Cancel
      </button>

      <button
        *ngIf="reservation.status === 'CANCELLED'"
        (click)="restore(reservation.id)"
        class="btn btn-success"
      >
        Restore
      </button>
    </div>
  </div>
</div>

<!-- Modal for cancellation reason -->
<div *ngIf="selectedReservationId" class="modal-overlay">
  <div class="modal-content">
    <h3>Cancel Reservation</h3>

    <label for="reason">Select Reason:</label>
    <select name="reason" [(ngModel)]="selectedReason">
      <option *ngFor="let reason of cancellationReasons" [value]="reason">
        {{ reasonLabels[reason] }}
      </option>
    </select>

    <div *ngIf="selectedReason === 'OTHER'" style="margin-top: 10px;">
      <input
        type="text"
        [(ngModel)]="customReason"
        placeholder="Enter custom reason"
        class="role-select"
      />
    </div>

    <div style="margin-top: 15px;">
      <button (click)="confirmCancellation()" class="btn btn-danger me-2">Confirm Cancellation</button>
      <button (click)="closeCancelModal()" class="btn">Cancel</button>
    </div>
  </div>
</div>
